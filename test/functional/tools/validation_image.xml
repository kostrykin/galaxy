<tool id="validation_image" name="validation_image" version="1.0">
    <command><![CDATA[
      cp '$input' '$output'
    ]]></command>
    <inputs>
        <param name="input" type="data" format="data" />
    </inputs>
    <outputs>
        <data name="output" format="data" />
    </outputs>
    <tests>
        <!-- Tests with intensity images -->
        <test>
            <param name="input" value="im1_uint8.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_width value="32" />
                    <has_image_height value="32" />
                    <has_image_channels value="1" />
                    <has_image_center_of_mass point="15.61, 15.48" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_width value="32" />
                    <has_image_height value="32" />
                    <has_image_channels value="3" />
                    <has_image_center_of_mass channel="0" point="7.5, 7.5" />
                    <has_image_mean_intensity channel="0" value="0.25" />
                    <has_image_mean_intensity channel="1" value="0.0" />
                    <has_image_mean_intensity channel="2" value="0" />
                    <has_image_center_of_mass point="7.5, 7.5" />
                    <has_image_mean_intensity value="0.08333333333" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" value="0.24" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" value="0.24" eps="0.0100000001" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" value="0.23" delta="2" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" value="0.22" delta="2" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" min="0.24" max="0.26" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" max="0.24" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im3_b.tif" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_intensity channel="0" min="0.26" />
                </assert_contents>
            </output>
        </test>
        <!-- Tests with label images -->
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_width value="32" />
                    <has_image_height value="32" />
                    <has_image_channels value="1" />
                    <has_image_labels value="1" exclude_labels="0" />
                    <has_image_mean_object_size value="256" exclude_labels="0" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_width value="32" />
                    <has_image_height value="32" />
                    <has_image_channels value="1" />
                    <has_image_labels value="2" />
                    <has_image_mean_object_size value="512" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_object_size labels="0" value="768" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_object_size labels="0, 1" value="512" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_object_size value="511" eps="0.9" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_width value="32" />
                    <has_image_height value="32" />
                    <has_image_channels value="1" />
                    <has_image_labels value="2" />
                    <has_image_mean_object_size value="511" eps="1.0" />
                </assert_contents>
            </output>
        </test>
        <test>
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_object_size min="511" max="513" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_object_size max="511" />
                </assert_contents>
            </output>
        </test>
        <test expect_test_failure="true">
            <param name="input" value="im2_b.png" />
            <output name="output">
                <assert_contents>
                    <has_image_mean_object_size min="513" />
                </assert_contents>
            </output>
        </test>
    </tests>
</tool>